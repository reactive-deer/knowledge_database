### DISKPART

---

В cmd используем команду diskpart для перехода в оболочку редактирования дисков, разделов и др.

Справка - ***help <command>*** (например, help list)



#### Опции

```
ACTIVE      - Пометка выбранного раздела как активного.
ADD         - Добавление зеркала к простому тому.
ASSIGN      - Назначение имени или точки подключения выбранному тому.
ATTRIBUTES  - Работа с атрибутами тома или диска.
ATTACH      - Присоединяет файл виртуального диска.
AUTOMOUNT   - Включение и отключение автоматического подключения базовых томов.
BREAK       - Разбиение зеркального набора.
CLEAN       - Очистка сведений о конфигурации или всех данных на диске.
COMPACT     - Попытки уменьшения физического размера файла.
CONVERT     - Преобразование форматов диска.
CREATE      - Создание тома, раздела или виртуального диска.
DELETE      - Удалить объект.
DETAIL      - Просмотр параметров объекта.
DETACH      - Отсоединяет файл виртуального диска.
EXIT        - Завершение работы DiskPart.
EXTEND      - Расширить том.
EXPAND     - Увеличение максимального доступного пространства на виртуальном диске.
FILESYSTEMS - Отображение текущей и поддерживаемой файловых систем для тома.
FORMAT      - Форматирование данного тома или раздела.
GPT         - Назначение атрибутов выбранному GPT-разделу.
HELP        - Отображение списка команд.
IMPORT      - Импорт группы дисков.
INACTIVE    - Пометка выбранного раздела как неактивного.
LIST        - Отображение списка объектов.
MERGE       - Объединение дочернего диска с родительскими.
ONLINE      - Перевод объекта, помеченного как "вне сети", в состояние "в сети".

OFFLINE     - Перевод в состояние "вне сети" объекта, помеченного как "в сети".
RECOVER     - Обновление состояния всех дисков выбранного пакета.
              Попытка восстановить диски неправильного пакета и
              повторная синхронизация зеркальных томов и томов RAID5 с
              устаревшим плексом или данными четности.
REM         - Не выполняет никаких действий. Используется для комментирования сц
енариев.
REMOVE      - Удаление имени диска или точки подключения.
REPAIR      - Восстановление тома RAID-5 с отказавшим участником.
RESCAN      - Поиск дисков и томов на компьютере.
RETAIN      - Размещение служебного раздела на простом томе.
SAN         - Отображение или установка политики SAN для текущей загруженной ОС.

SELECT      - Установка фокуса на объект.
SETID       - Изменение типа раздела.
SHRINK      - Уменьшение размера выбранного тома.
UNIQUEID    - Отображение или установка кода таблицы разделов GUID (GPT) или
              подписи основной загрузочной записи (MBR) диска.
```





* Просмотреть список (`list [..]  `)
  - Дисков (`list disk`)
  - Логических томов  (`list volume`)
  - Разделов (`list partition`)



* **select   <disk, volume, partition>   <№>** (выбрать для работы диск, том)
* **detail   <disk, volume, partition>   <№>** (информация о выбранном диске, томе)



#### Редактирование буквы тома (volume)

*  Команда **assign**

   Том должен быть заранее выбран командой `select disk(volume) [..]`. После чего опцией **letter=<необходимая_буква>** присвоить новое значение
  
  ```shell
  select volume 0
assign letter=Y
  ```
  



#### Подготовительные работы с новыми дисками

1. Выбрать диск

2. Снять атрибут "только для чтения"

3. Перевести статус в "online"

4. Конвертировать в динамический

   ```powershell
   select disk X	#где X — номер диска
   attrib disk clear readonly
   online disk
   convert dynamic
   ```



#### Создание RAID

1. **RAID0** (`create volume stripe`)

   **create volume stripe**   [**size=** *n*]   [**disk=** *n*,*n*[,*n*,…]]   [**noerr**]

   Создание **чередующегося тома** на двух и более указанных динамических дисках. После создания тома фокус автоматически переносится на этот том.

   - **size=** *n*

     Объем в мегабайтах (МБ), который том будет занимать на каждом диске. Если размер не задан, новый том занимает все свободное пространство на самом маленьком диске и равный объем на каждом последующем диске.

   - **disk=** *n*,*n*[,*n*,…]

     Динамические диски, на которых создается том. Для создания чередующегося тома требуется наличие как минимум двух динамических дисков. На каждом диске выделяется пространство, размер которого определяется значением **size=** *n*.

   - **noerr**

     Только для сценариев. При возникновении ошибки программа DiskPart продолжает обрабатывать команды, как если бы ошибки не было. Если параметр **noerr** не задан, при возникновении ошибки программа DiskPart завершается и выдается код ошибки.

   

2. **RAID1** (`add disk`)

   **add disk=** *n*    [**noerr**]

   Отражение **простого тома** с фокусом на указанном диске.

   *n*

   Задание диска, на котором будет создано зеркало. Допускается создавать зеркала только простых томов. Необходимо, чтобы на указанном диске имелось незанятое место, размер которого не меньше размера простого тома, который требуется отразить.

   **noerr**

   Только для сценариев. При возникновении ошибки программа DiskPart продолжает обрабатывать команды, как если бы ошибки не было. Если параметр **noerr** не задан, при возникновении ошибки программа DiskPart завершается и выдается код ошибки.

   

3. **RAID5** (`create volume raid`)

   **create volume raid**    [**size=** *n*]   [**disk=** *n*,*n*,*n*[,*n*,…]]   [**noerr**]

   Создание **тома RAID-5** на трех и более указанных **динамических дисках**. После создания тома фокус автоматически переносится на этот том.

   - **size=** *n*

     Объем в мегабайтах (МБ), который том будет занимать на каждом диске. Если размер не указан, создается том RAID-5 максимального возможного размера. Размер тома RAID-5 определяется диском с наименьшим объемом непрерывного свободного места. Столько же свободного места выделяется на каждом диске. Фактический объем доступного дискового пространства на томе RAID-5 меньше суммы всего занятого дискового пространства, поскольку некоторая его часть требуется для четности.

   - **disk=** *n*,*n*,*n*[,*n*,…]

     Динамические диски, на которых создается том. Для создания тома RAID-5 требуется наличие как минимум трех динамических дисков. На каждом диске выделяется пространство, размер которого определяется значением **size=***n*.

   - **noerr**

     Только для сценариев. При возникновении ошибки программа DiskPart продолжает обрабатывать команды, как если бы ошибки не было. Если параметр **noerr** не задан, при возникновении ошибки программа DiskPart завершается и выдается код ошибки.







Источники:

* http://systemmanager.ru/deploy.ru/t_diskpart.htm
* https://ab57.ru/cmdlist/diskpart.html
* https://sourcedaddy.com/windows-7/using-diskpart-create-striped-mirrored-and-raid-5-volumes.html
* https://community.infosecinstitute.com/discussion/50146/whats-the-diff-of-spanned-and-simple-volume#:~:text=A%20spanned%20volume%20is%20created,two%20or%20more%20physical%20disks.